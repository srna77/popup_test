<!DOCTYPE html>
<html style="margin:0;height:100%">
	<head> 
		<meta charset="utf-8">
		<title>Crownix HTML5 Viewer</title>
		<meta name="viewport" content="width=device-width, user-scalable=no">
		<script src="js/viewer/jquery-1.11.0.min.js"></script>
		<!--<script src="../js/jquery-1.11.0.min.js"></script>-->
		<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.4.2/pure-min.css">
			<script>
			function getCheckedList(chkList, history_txt)
			{
				var result = "";
				for(i=0;i<chkList.length;i++){
					if(chkList[i].checked == true){
						if(result != "")
							result += ", ";
						result += chkList[i].value;
					}
				}
				
				if(history_txt.value != "")
					result += "," + history_txt.value;
				return result;
			};
			window.onload = function() {			
				document.getElementById('submit').onclick = function() {
					//var cxOpener = window.opener.cxOpener;
					//if(cxOpener != undefined)
					//{
						/*
						var image = $('#image');
						var canvas = document.createElement('canvas');
						canvas.width = image.width();
						canvas.height = image.height();
						var ctx = canvas.getContext('2d');
						ctx.drawImage(image.get(0), 0,0, image.width(), image.height());

						var sign = $('#sign');
						var signCanvas = document.createElement('canvas');
						signCanvas.width = sign.width();
						signCanvas.height = sign.height();
						var signCtx = signCanvas.getContext('2d');
						signCtx.drawImage(sign.get(0), 0,0, sign.width(), sign.height());

						var valueList = {
							// text는 그냥 값
							'text1': document.getElementById('text1').value,
							'text2': document.getElementById('text2').value,
							// 체크박스는 이놈이 체크 되었는지
							'check1': document.getElementById('oh').checked,
							'check2': document.getElementById('my').checked,
							'check3': document.getElementById('zsh').checked,
							// 라디오버튼은 체크된 녀석의 아이디
							'group1': $('[name=group1]:checked').attr('id'),

							// 콤보박스는 그냥 값
							'combobox1': document.getElementById('combobox1').value,
							// base64
							//'picture1': canvas.toDataURL('image/png'),
							//'sign1': signCanvas.toDataURL('image/png'),
						};
	*/
						var valueList = {
							'P_History': getCheckedList(document.getElementsByName('historys'), document.getElementById('history_txt')),
						};
												
						window.parent.postMessage({ childData : 'test data' }, 'http://192.168.10.78:8080/depl/test/viewer/viewer.html');
						
						//console.log(parent.viewer);
						//cxOpener.set(valueList);
					//}
					//else
					//{
					//	window.opener.cxviewer.SetFormFieldData("Form0001", "P_History", getCheckedList(document.getElementsByName('historys'), document.getElementById('history_txt')));	
				
					/*
					window.opener.rdviewer.SetFormFieldData("popupdata","text1",document.getElementById('text1').value);
					window.opener.rdviewer.SetFormFieldData("popupdata","text2",document.getElementById('text2').value);
					// 라디오
					window.opener.rdviewer.SetFormFieldData("popupdata",$('[name=group1]:checked').attr('id'),"1");
					// 체크
					window.opener.rdviewer.SetFormFieldData("popupdata","check1",$('#oh').is(":checked") ? '1' : '0');
					window.opener.rdviewer.SetFormFieldData("popupdata","check2",$('#my').is(":checked") ? '1' : '0');
					window.opener.rdviewer.SetFormFieldData("popupdata","check3",$('#zsh').is(":checked") ? '1' : '0');
					// 콤보
					window.opener.rdviewer.SetFormFieldData("popupdata","combobox1", document.getElementById('combobox1').value);
					// 그림
					window.opener.rdviewer.SetFormFieldData("popupdata","picture1", canvas.toDataURL('image/png'));
					window.opener.rdviewer.SetFormFieldData("popupdata","sign1", signCanvas.toDataURL('image/png'));*/
					//}
					//self.close();
				}
			};
		</script>
	</head>
	<body style="padding:10px; height:100%">
	<img src="http://192.168.10.6:8080/TestWeb/popup/med.jpg" width="80" height="80"/> 과거력 체크<br/>
		
		<form class="pure-form pure-form-stacked">
			<fieldset>
				<legend>병력 리스트</legend>

				<div class="pure-control-group">
						<input type="checkbox" name="historys" value="안구 건조증">안구 건조증</input><br/>
					 	<input type="checkbox" name="historys" value="알레르기">알레르기</input><br/>
					    <input type="checkbox" name="historys" value="눈수술">눈수술</input><br/>
					    <input type="checkbox" name="historys" value="과거 시력 저하를 일으킨 눈병">과거 시력 저하를 일으킨 눈병</input><br/>
					    <input type="checkbox" name="historys" value="고혈압">고혈압</input><br/>
					    <input type="checkbox" name="historys" value="당뇨병">당뇨병</input><br/>
					    <input type="checkbox" name="historys" value="류마티스">류마티스</input><br/>
					    <input type="checkbox" name="historys" value="현재 임신과 수유">현재 임신과 수유</input><br/>
						<label for=history_txt>기타</label> 
					    <input type="text" id="history_txt" value=""/>
						
				</div>
			</fieldset>
				<button type="button" id="submit" class="pure-button pure-button-primary" >적용</button>
		</form>
	</body>
</html>
