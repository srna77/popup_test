<!DOCTYPE html>
<html style="margin:0;height:100%">
	<head> 
		<meta charset="utf-8">
		<title>Crownix HTML5 Viewer</title>
		<meta name="viewport" content="width=device-width, user-scalable=no">
		<script src="js/viewer/jquery-1.11.0.min.js"></script>
		<!--<script src="../js/jquery-1.11.0.min.js"></script>
		<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.4.2/pure-min.css">-->
		<script>
			function getCheckedList(chkList, history_txt)
			{
				var result = "";
				for(i=0;i<chkList.length;i++){
					if(chkList[i].checked == true){
						if(result != "")
							result += ", ";
						result += chkList[i].value;
					}
				}
				
				if(history_txt.value != "")
					result += "," + history_txt.value;
				return result;
			};
						
			window.onload = function() {
				window.onerror = function(errMsg, url, lineNumber, column, errorObj){
					$('#err').text($('#err').text() + errMsg, url, lineNumber, column, errorObj);
				};
				document.getElementById('submit').onclick = function() {
					var valueList = {
							'P_History': getCheckedList(document.getElementsByName('historys'), document.getElementById('history_txt')),
					};
					if(window.opener) {
						//document.domain = '*';
						cxOpener = window.opener.cxOpener;
						cxOpener.set(valueList);
						self.close();
					} else {
						window.parent.postMessage({cxOpener:{'set':valueList}}, '*');
						//parent.cxOpener.set(valueList);
						//parent.cxMirroringOverlay.remove();
						//parent.cxMirroringPopup.remove();
					}
				};
				
			};
			
			$(window).on("message onmessage", function(e) {
				var data = e.originalEvent.data;
				if(data.setText) {
					document.getElementById(data.setText.id).value = data.setText.value;
				}
			});
					
 			</script>
	</head>
	<body style="padding:10px; height:100%">
		<div id="err" style="padding:10px; height:20%"></div>
		
	 과거력 체크<br/>
		
		<form class="pure-form pure-form-stacked">
			<fieldset>
				<legend>병력 리스트</legend>

				<div class="pure-control-group">
						<input type="checkbox" name="historys" value="안구 건조증">안구 건조증</input><br/>
					 	<input type="checkbox" name="historys" value="알레르기">알레르기</input><br/>
					    <input type="checkbox" name="historys" value="눈수술">눈수술</input><br/>
					    <input type="checkbox" name="historys" value="과거 시력 저하를 일으킨 눈병">과거 시력 저하를 일으킨 눈병</input><br/>
					    <input type="checkbox" name="historys" value="고혈압">고혈압</input><br/>
					    <input type="checkbox" name="historys" value="당뇨병">당뇨병</input><br/>
					    <input type="checkbox" name="historys" value="류마티스">류마티스</input><br/>
					    <input type="checkbox" name="historys" value="현재 임신과 수유">현재 임신과 수유</input><br/>
						<label for=history_txt>기타</label> 
					    <input type="text" id="history_txt" value=""/>
						
				</div>
			</fieldset>
				<button type="button" id="submit" class="pure-button pure-button-primary" >적용</button>
		</form>
	</body>
</html>
